<!--
  ========================LICENSE_START=================================
  screenit-huisartsenportaal
  %%
  Copyright (C) 2016 - 2021 Facilitaire Samenwerking Bevolkingsonderzoek
  %%
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
  
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
  
  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  =========================LICENSE_END==================================
  -->
<div class="col-md-12">
    <div class="content">
        <h1>Overzicht verrichtingen</h1>
        <div class="panel panel-default clearfix locatie-panel">
            <div class="panel-body">
                <form class="form-horizontal" ng-submit="form.zoeken(form.verrichtingenZoekObject, verrichtingform)"
                      name="verrichtingform">

                    <fieldset>
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group" show-errors>
                                    <label class="col-sm-4">Locatie:</label>
                                    <div class="col-sm-8">
                                        <div class="input-group">
                                            <ui-select ng-model="form.verrichtingenZoekObject.locatie">
                                                <ui-select-match placeholder="Kies er een....">
                                                    <span ng-class="{'text-danger' : $select.selected.status === 'INACTIEF'}">{{$select.selected.naam || $select.search}}</span>
                                                </ui-select-match>
                                                <ui-select-choices
                                                        repeat="locatie in (form.huisarts.locaties | filter: { naam: $select.search }) track by locatie.huisartsportaalId">
                                                <span ng-if="locatie.status === 'INACTIEF'"
                                                      class="label label-danger">verwijderd</span>
                                                    {{locatie.naam}}
                                                </ui-select-choices>
                                            </ui-select>

                                            <span class="input-group-btn">
                                      <button type="button" ng-click="form.verrichtingenZoekObject.locatie = undefined"
                                              class="btn btn-date btn-default">
                                        <span class="glyphicon glyphicon-trash"></span>
                                      </button>
                                    </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group" show-errors>
                                    <label class="col-sm-4">Naam client:</label>
                                    <div class="col-sm-8">
                                        <input class="form-control" type="text"
                                               ng-model="form.verrichtingenZoekObject.clientNaam"/>
                                    </div>
                                </div>

                            </div>
                            <div class="col-sm-6">

                                <div class="form-group"
                                     ng-class="{true: 'has-error', false: ''}[verrichtingform.VanafDatum.$invalid]">
                                    <label class="col-sm-4">Verrichtingsdatum vanaf:</label>
                                    <div class="col-sm-8">
                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="dd-mm-jjjj"
                                                   name="VanafDatum" uib-datepicker-popup="{{form.dateformat}}"
                                                   ng-model="form.verrichtingenZoekObject.verrichtingsDatumVanaf"
                                                   is-open="form.verrichtingDatumPopupVanafOpen"
                                                   datepicker-options="dateOptions" current-text="Vandaag"
                                                   clear-text="Reset" close-text="Sluiten"/>
                                            <span class="input-group-btn">
                                            <button type="button" class="btn-date btn btn-default"
                                                    ng-click="form.open1()"><i class="glyphicon glyphicon-calendar"></i></button>
                                        </span>
                                        </div>
                                        <div ng-messages="verrichtingform.VanafDatum.$error"
                                             ng-if="!verrichtingform.VanafDatum.$pristine">
                                            <span ng-messages-include="assets/js/components/default-form-error.tmpl.html"></span>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group"
                                     ng-class="{true: 'has-error', false: ''}[verrichtingform.TotenmetDatum.$invalid]"
                                     id="totenmet-datum-form-group">
                                    <label class="col-sm-4">Verrichtingsdatum t/m:</label>
                                    <div class="col-sm-8">
                                        <p class="input-group">
                                            <input name="TotenmetDatum" type="text"
                                                   thisearlierthan="form.verrichtingenZoekObject.verrichtingsDatumVanaf"
                                                   class="form-control" placeholder="dd-mm-jjjj"
                                                   uib-datepicker-popup="{{form.dateformat}}"
                                                   ng-model="form.verrichtingenZoekObject.verrichtingsDatumTotenmet"
                                                   is-open="form.verrichtingDatumPopuptmOpen"
                                                   datepicker-options="dateOptions" current-text="Vandaag"
                                                   clear-text="Reset" close-text="Sluiten"/>
                                            <span class="input-group-btn">
                                            <button type="button" class="btn-date btn btn-default"
                                                    ng-click="form.open2()"><i class="glyphicon glyphicon-calendar"></i></button>
                                        </span>
                                        </p>
                                        <div ng-messages="verrichtingform.TotenmetDatum.$error"
                                             ng-if="!verrichtingform.TotenmetDatum.$pristine">
                                            <span ng-messages-include="assets/js/components/default-form-error.tmpl.html"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group"
                                     ng-class="{true: 'has-error', false: ''}[verrichtingform.DatumUitstrijkje.$invalid]">
                                    <label class="col-sm-4">Datum uitstrijkje:</label>
                                    <div class="col-sm-8">
                                        <div class="input-group">
                                            <input type="text" class="form-control" name="DatumUitstrijkje"
                                                   placeholder="dd-mm-jjjj" uib-datepicker-popup="{{form.dateformat}}"
                                                   ng-model="form.verrichtingenZoekObject.datumUitstrijkje"
                                                   is-open="form.datumUitstrijkjePopupOpen" datepicker-options="dateOptions"
                                                   current-text="Vandaag" clear-text="Reset" close-text="Sluiten"/>
                                            <span class="input-group-btn">
                                            <button type="button" class="btn-date btn btn-default"
                                                    ng-click="form.open3()"><i class="glyphicon glyphicon-calendar"></i></button>
                                        </span>
                                        </div>
                                        <div ng-messages="verrichtingform.DatumUitstrijkje.$error"
                                             ng-if="!verrichtingform.DatumUitstrijkje.$pristine">
                                            <span ng-messages-include="assets/js/components/default-form-error.tmpl.html"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="filter-btn-row">
                                <button class="btn btn-primary">Filteren</button>
                            </div>
                        </div>
                    </fieldset>
                </form>
                <hr>
                <div class="verrichtingen-export row">
                    <a class="btn btn-default btn-export" title="Exporteren" field-separator=";" csv-header="form.csvHeader"
                       filename="overzicht-verrichtingen.csv" ng-csv="form.getCsvExportData()" add-bom="true">Exporteren</a>
                </div>
                <div class="verrichtingen-table-container scroll-x">
                    <table ng-table="form.tableParams" template-pagination="pager-template" class="table table-verrichtingen table-striped table-hover">
                        <tr ng-repeat="row in $data track by row.huisartsportaalId">
                            <td data-title="'Huisartslocatie'" sortable="'huisartsLocatie.naam'">
                                {{row.huisartsLocatieNaam}}
                            </td>
                            <td data-title="'Naam cli&euml;nt'" sortable="'clientNaam'">{{row.clientNaam}}</td>
                            <td data-title="'Monster-id'" sortable="'monsterId'">{{row.monsterId}}</td>
                            <td data-title="'Datum uitstrijk'" header-class="'wrappable'" sortable="'datumUitstrijkje'">{{row.datumUitstrijkje |
                                date:'dd-MM-yyyy'}}
                            </td>
                            <td data-title="'Datum verrichting'" header-class="'wrappable'" sortable="'verrichtingsDatum'">{{row.verrichtingsDatum |
                                date:'dd-MM-yyyy'}}
                            </td>
                            <td data-title="'Ontvangst formulier'" header-class="'wrappable'" sortable="'formulierOntvangstDatum'">
                                {{row.formulierOntvangstDatum | date:'dd-MM-yyyy'}}
                            </td>
                            <td data-title="'Screeningsorganisatie'" sortable="'regio'">{{row.regio}}</td>
                        </tr>
                    </table>
                </div>
                <div class="row tabel-totalen">

                    <strong>Aantal uitstrijkjes:</strong> <span ng-bind="form.totalen.aantalVerrichtingen"></span>
                </div>
            </div>

        </div>
    </div>
</div>

<script type="text/ng-template" id="pager-template">
    <div class="row">
        <div class="ng-cloak ng-table-pager">
            <ul class="pagination ng-table-pagination pull-right">
                <li ng-class="{'disabled': !page.active}" ng-repeat="page in pages" ng-switch="page.type">
                    <a ng-switch-when="prev" ng-click="params.page(page.number)" href="">&laquo;</a>
                    <a ng-switch-when="first" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a>
                    <a ng-switch-when="page" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a>
                    <a ng-switch-when="more" ng-click="params.page(page.number)" href="">&#8230;</a>
                    <a ng-switch-when="last" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a>
                    <a ng-switch-when="next" ng-click="params.page(page.number)" href="">&raquo;</a>
                </li>
            </ul>
        </div>
    </div>
</script>
